/**
 * @file Firestore Security Rules
 * @core-philosophy This ruleset grants open access to all data in the database. This is intended for prototyping or internal tools where security is not a primary concern.
 * @data-structure All data is stored in top-level collections: /partners, /loans, /installments, /payments, /receipts, and /reports.
 * @key-security-decisions Listing of users, partners or other sensitive information is not explicitly denied. All reads and writes are open to any authenticated user.
 *
 * WARNING: This ruleset is for PROTOTYPING ONLY. Do not use in a production environment without implementing proper security measures.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Grants open read and write access to the partners collection.
     * @path /partners/{partnerId}
     * @allow (get, list) Any authenticated user can read partner data.
     * @allow (create, update, delete) Any authenticated user can create, update, or delete partner data.
     * @deny none
     * @principle Grants open access to the partners collection for prototyping.
     */
    match /partners/{partnerId} {
      allow get, list: if isSignedIn();
      allow create, update, delete: if isSignedIn();
    }

    /**
     * @description Grants open read and write access to the loans collection.
     * @path /loans/{loanId}
     * @allow (get, list) Any authenticated user can read loan data.
     * @allow (create, update, delete) Any authenticated user can create, update, or delete loan data.
     * @deny none
     * @principle Grants open access to the loans collection for prototyping.
     */
    match /loans/{loanId} {
      allow get, list: if isSignedIn();
      allow create, update, delete: if isSignedIn();
    }

    /**
     * @description Grants open read and write access to the installments collection.
     * @path /installments/{installmentId}
     * @allow (get, list) Any authenticated user can read installment data.
     * @allow (create, update, delete) Any authenticated user can create, update, or delete installment data.
     * @deny none
     * @principle Grants open access to the installments collection for prototyping.
     */
    match /installments/{installmentId} {
      allow get, list: if isSignedIn();
      allow create, update, delete: if isSignedIn();
    }

    /**
     * @description Grants open read and write access to the payments collection.
     * @path /payments/{paymentId}
     * @allow (get, list) Any authenticated user can read payment data.
     * @allow (create, update, delete) Any authenticated user can create, update, or delete payment data.
     * @deny none
     * @principle Grants open access to the payments collection for prototyping.
     */
    match /payments/{paymentId} {
      allow get, list: if isSignedIn();
      allow create, update, delete: if isSignedIn();
    }

    /**
     * @description Grants open read and write access to the receipts collection.
     * @path /receipts/{receiptId}
     * @allow (get, list) Any authenticated user can read receipt data.
     * @allow (create, update, delete) Any authenticated user can create, update, or delete receipt data.
     * @deny none
     * @principle Grants open access to the receipts collection for prototyping.
     */
    match /receipts/{receiptId} {
      allow get, list: if isSignedIn();
      allow create, update, delete: if isSignedIn();
    }

    /**
     * @description Grants open read and write access to the reports collection.
     * @path /reports/{reportId}
     * @allow (get, list) Any authenticated user can read report data.
     * @allow (create, update, delete) Any authenticated user can create, update, or delete report data.
     * @deny none
     * @principle Grants open access to the reports collection for prototyping.
     */
    match /reports/{reportId} {
      allow get, list: if isSignedIn();
      allow create, update, delete: if isSignedIn();
    }

    /**
     * @description Grants open read and write access to the documents collection.
     * @path /documents/{document=**}
     * @allow (get, list) Any authenticated user can read document data.
     * @allow (create, update, delete) Any authenticated user can create, update, or delete document data.
     * @deny none
     * @principle Grants open access to the documents collection for prototyping.
     */
    match /{document=**} {
        allow read, write: if isSignedIn();
    }

  }

  function isSignedIn() {
    return request.auth != null;
  }
}